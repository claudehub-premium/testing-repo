# Represents a discovered vulnerability
class Vulnerability
  enum Severity
    LOW
    MEDIUM
    HIGH
    CRITICAL
  end

  getter title : String
  getter description : String
  getter severity : Severity
  getter location : String
  getter recommendation : String
  getter metadata : Hash(String, String)

  def initialize(
    @title : String,
    @description : String,
    @severity : Severity,
    @location : String,
    @recommendation : String,
    @metadata : Hash(String, String) = {} of String => String
  )
  end

  def to_s(io : IO)
    io << "[#{@severity}] #{@title}\n"
    io << "  Location: #{@location}\n"
    io << "  Description: #{@description}\n"
    io << "  Recommendation: #{@recommendation}\n"
    unless @metadata.empty?
      io << "  Metadata:\n"
      @metadata.each do |key, value|
        io << "    #{key}: #{value}\n"
      end
    end
  end
end
